<GROUP_BY_programmers_A>

* GROUP BY
1. 자동차 종류 별 특정 옵션이 포함된 자동차 수 구하기
- 아래 방법으로는 안되는지 시도해봤지만 안됐음.
  검색해보니 내가 원하는 방식은 없는 것 같음.
SELECT CAR_TYPE , COUNT(CAR_TYPE) AS CARS 
FROM CAR_RENTAL_COMPANY_CAR
WHERE OPTIONS IN ('%통풍시트%' , '%열선시트%' , '%가죽시트%')
GROUP BY CAR_TYPE
Order by CAR_TYPE;



- 최종 답안
SELECT  CAR_TYPE, COUNT (CAR_TYPE) AS  CARS
FROM  CAR_RENTAL_COMPANY_CAR 
WHERE  OPTIONS LIKE '%시트%'
GROUP  BY  CAR_TYPE
ORDER  BY  CAR_TYPE;





2. 고양이와 개는 몇 마리 있을까
SELECT ANIMAL_TYPE  , COUNT(ANIMAL_TYPE ) AS COUNT
FROM ANIMAL_INS  
GROUP BY ANIMAL_TYPE 
Order by ANIMAL_TYPE ;





3. 동명 동물 수 찾기
SELECT NAME , COUNT(NAME) AS COUNT
FROM ANIMAL_INS
GROUP BY NAME
HAVING COUNT(NAME) >= 2
Order by NAME;





4. 입양 시각 구하기(1)
SELECT DATETIME AS HOUR, COUNT(DATETIME) AS COUNT
FROM ANIMAL_OUTS  
GROUP BY DATETIME
Order by DATETIME 


SELECT DATETIME_FORMAT(DATETIME, 'H') FROM ANIMAL_OUTS  
LIMIT 3;





5. 성분으로 구분한 아이스크림 총 주문량
SELECT T2.INGREDIENT_TYPE , SUM(T1.TOTAL_ORDER) AS TOTAL_ORDER
FROM FIRST_HALF  T1
INNER JOIN ICECREAM_INFO T2
ON T1.FLAVOR = T2.FLAVOR
GROUP BY T2.INGREDIENT_TYPE
Order by T1.TOTAL_ORDER;





6. 즐겨찾기가 가장 많은 식당 정보 출력하기
- 아래 방법으로 풀어보고싶었는데 일식만 출력이 안되는 문제를 해결하지 못했음.
SELECT FOOD_TYPE , REST_ID , REST_NAME , FAVORITES
FROM REST_INFO
GROUP BY FOOD_TYPE
HAVING FAVORITES = MAX(FAVORITES)
Order by FOOD_TYPE DESC;



- 새로운 문법 답안
SELECT  FOOD_TYPE, REST_ID, REST_NAME, FAVORITES
FROM  REST_INFO
WHERE  (FOOD_TYPE, FAVORITES) 
IN  
( SELECT  FOOD_TYPE, MAX (FAVORITES)
FROM  REST_INFO
GROUP  BY  FOOD_TYPE )
ORDER  BY  FOOD_TYPE DESC



- 서브 쿼리 활용 답안
SELECT FOOD_TYPE , REST_ID , REST_NAME , FAVORITES
from rest_info
WHERE FOOD_TYPE IN(SELECT FOOD_TYPE FROM rest_info
GROUP BY FOOD_TYPE
HAVING FAVORITES = MAX(FAVORITES))
Order by FOOD_TYPE DESC





7. 조건에 맞는 사용자와 총 거래금액 조회하기
SELECT T1.WRITER_ID AS USER_ID , T2.NICKNAME , SUM(T1.PRICE) AS TOTAL_SALES
FROM USED_GOODS_BOARD T1

INNER JOIN USED_GOODS_USER T2
ON T1.WRITER_ID = T2.USER_ID
WHERE STATUS = 'DONE'
GROUP BY T1.WRITER_ID
HAVING SUM(T1.PRICE) >= 700000

ORDER BY TOTAL_SALES;



SUM(T2.SALES) AS TOTAL_SALES

8. 카테고리 별 도서 판매량 집계하기
SELECT T1.CATEGORY , 
SUM(T2.SALES) AS TOTAL_SALES
FROM BOOK T1

INNER JOIN BOOK_SALES T2
ON T1.BOOK_ID = T2.BOOK_ID
WHERE YEAR(T2.SALES_DATE) = 2022 AND MONTH(T2.SALES_DATE) = 1
GROUP BY T1.CATEGORY

Order by T1.CATEGORY;